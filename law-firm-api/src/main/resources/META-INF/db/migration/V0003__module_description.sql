-- 系统模块架构说明
-- 版本: V0003
-- 模块: API (系统基础层)
-- 创建时间: 2023-06-01
-- 说明: 系统整体架构和模块划分说明文档

/*
=============================================================================
                        律师事务所管理系统 - 数据库架构说明
=============================================================================

一、系统架构层次
├── API层 (V0001-V0999)     - 系统基础层，提供核心基础服务
├── 系统模块 (V1000-V1999)   - 系统管理功能
├── 认证模块 (V2000-V2999)   - 用户认证与权限管理
├── 人员模块 (V3000-V3999)   - 人员信息管理
├── 案件模块 (V4000-V4999)   - 案件业务管理
└── 扩展模块 (V5000+)       - 未来功能扩展

二、版本号规划
- V0001-V0999:  API基础层 (系统配置、字典、日志、存储等)
- V1000-V1999:  系统管理 (菜单、角色、组织、定时任务等)
- V2000-V2999:  认证授权 (用户、权限、数据权限等)
- V3000-V3999:  人员管理 (律师、员工、客户、联系人等)
- V4000-V4999:  案件管理 (案件、文档、任务、费用等)
- V5000+:       扩展功能 (财务、报表、工作流等)

三、标准脚本结构
每个模块包含3个标准脚本：
- V[模块]000: 模块说明文档
- V[模块]001: 表结构定义
- V[模块]002: 基础数据初始化

四、API层基础表 (V0001)
=============================================================================
1. 系统配置表
   - sys_config: 系统配置参数

2. 数据字典表
   - sys_dict_type: 字典类型定义
   - sys_dict_data: 字典数据项

3. 系统日志表
   - sys_login_log: 登录日志
   - sys_operation_log: 操作日志

4. 文件存储表
   - storage_bucket: 存储桶配置
   - storage_file: 文件信息

5. 系统监控表
   - sys_monitor_server: 服务器监控

五、数据库设计规范
=============================================================================
1. 命名规范
   - 表名: 小写字母+下划线，模块前缀
   - 字段名: 小写字母+下划线
   - 索引名: idx_字段名 或 uk_字段名(唯一)
   - 外键名: fk_表名_字段名

2. 字段规范
   - 主键: id BIGINT PRIMARY KEY AUTO_INCREMENT
   - 租户: tenant_id BIGINT DEFAULT 0
   - 状态: status TINYINT DEFAULT 1 (0-禁用,1-正常)
   - 删除: deleted TINYINT DEFAULT 0 (0-正常,1-删除)
   - 版本: version INT DEFAULT 0 (乐观锁)
   - 排序: sort INT DEFAULT 0
   - 时间: create_time, update_time DATETIME
   - 操作人: create_by, update_by VARCHAR(50)
   - 备注: remark VARCHAR(255)

3. 字符集规范
   - 统一使用: utf8mb4
   - 排序规则: utf8mb4_unicode_ci
   - 存储引擎: InnoDB

4. 索引规范
   - 主键索引: 自动创建
   - 唯一索引: 业务唯一字段
   - 普通索引: 查询频繁字段
   - 复合索引: 多字段组合查询

5. 外键规范
   - 明确定义外键约束
   - 级联删除: ON DELETE CASCADE (谨慎使用)
   - 级联更新: ON UPDATE CASCADE

六、业务模块说明
=============================================================================
1. 系统管理模块 (V1000+)
   - 菜单管理: 系统菜单结构
   - 角色管理: 角色权限分配
   - 组织管理: 组织架构管理
   - 定时任务: 系统定时任务

2. 认证授权模块 (V2000+)
   - 用户管理: 用户账号信息
   - 权限管理: 功能权限控制
   - 数据权限: 数据访问控制
   - 登录认证: 登录验证机制

3. 人员管理模块 (V3000+)
   - 人员基础: 个人基本信息
   - 律师管理: 律师专业信息
   - 员工管理: 员工工作信息
   - 客户管理: 客户关系管理

4. 案件管理模块 (V4000+)
   - 案件信息: 案件基本信息
   - 案件文档: 案件相关文档
   - 案件任务: 案件处理任务
   - 费用管理: 案件费用核算

七、数据安全与性能
=============================================================================
1. 数据安全
   - 软删除: 使用deleted字段标记
   - 数据加密: 敏感信息加密存储
   - 访问控制: 基于角色的权限控制
   - 审计日志: 完整的操作日志记录

2. 性能优化
   - 索引优化: 合理创建索引
   - 分页查询: 避免全表扫描
   - 缓存策略: 热点数据缓存
   - 读写分离: 主从数据库分离

3. 数据一致性
   - 事务控制: 保证数据一致性
   - 乐观锁: 防止并发更新冲突
   - 外键约束: 保证引用完整性
   - 数据校验: 业务规则校验

八、部署与维护
=============================================================================
1. 环境要求
   - MySQL 8.0+
   - 字符集: utf8mb4
   - 时区: Asia/Shanghai
   - 存储引擎: InnoDB

2. 初始化步骤
   1. 创建数据库
   2. 执行API层脚本 (V0001-V0003)
   3. 执行业务模块脚本 (V1000+)
   4. 验证数据完整性

3. 维护建议
   - 定期备份数据库
   - 监控数据库性能
   - 定期清理日志数据
   - 更新统计信息

=============================================================================
                              文档版本: 1.0.0
                              最后更新: 2023-06-01
                              维护人员: 系统管理员
=============================================================================
*/

-- 此脚本仅包含说明文档，不执行任何SQL操作
SELECT '系统模块架构说明文档已加载' AS message; 