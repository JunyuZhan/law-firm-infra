# 律师事务所管理系统启动说明

## 系统环境要求

- JDK 17 或更高版本
- Maven 3.8 或更高版本
- MySQL 8.0 或更高版本（当启用数据库功能时）
- Redis（可选，当启用缓存功能时）

## 配置说明

系统支持多环境配置，主要包括：

1. **开发环境**（develop）：适用于日常开发，支持H2内存数据库或MySQL
2. **测试环境**（test）：适用于功能测试，需配置测试数据库
3. **生产环境**（prod）：适用于实际部署，需配置生产数据库

## 模块功能配置

在`module-config.properties`文件中可以配置各模块的启用状态：

```properties
# 数据库核心功能
lawfirm.database.enabled=true

# 消息服务模块配置
lawfirm.message.enabled=false

# 安全模块配置
lawfirm.security.enabled=false

# 工作流模块配置
lawfirm.workflow.enabled=false

# 存储模块配置
lawfirm.storage.enabled=true
lawfirm.storage.type=LOCAL

# 搜索模块配置
lawfirm.search.enabled=false
```

## 构建项目

```bash
# 在项目根目录执行
mvn clean package -DskipTests
```

## 启动方式

### 方式1：使用批处理脚本（Windows）

我们提供了针对不同环境的启动脚本：

- **开发环境**：双击运行 `start-dev.bat`
- **测试环境**：双击运行 `start-test.bat`
- **生产环境**：双击运行 `start-prod.bat`（需自行创建）

### 方式2：命令行启动

```bash
# 开发环境
java -jar target/law-firm-api-1.0.0.jar --spring.profiles.active=develop

# 测试环境
java -jar target/law-firm-api-1.0.0.jar --spring.profiles.active=test

# 生产环境
java -jar target/law-firm-api-1.0.0.jar --spring.profiles.active=prod
```

### 方式3：Docker启动（需要Docker环境）

```bash
# 构建镜像
docker build -t lawfirm-api:latest .

# 运行容器（开发环境）
docker run -p 8080:8080 -e SPRING_PROFILES_ACTIVE=develop lawfirm-api:latest
```

## 无数据库模式

如果您想在没有配置数据库的情况下启动系统（适用于前端开发或演示目的），可以修改配置：

1. 修改`module-config.properties`文件，设置`lawfirm.database.enabled=false`
2. 重新启动系统

在无数据库模式下：
- 系统会使用内存中的模拟数据
- 登录认证使用简化处理器
- 所有需要数据库的服务会使用空操作实现

## 常见问题

1. **启动失败，提示数据库连接错误**
   - 检查数据库配置是否正确
   - 确认数据库服务是否启动
   - 可以尝试设置`lawfirm.database.enabled=false`使用无数据库模式

2. **登录认证失败**
   - 在有数据库模式下，检查用户表中是否有对应用户
   - 在无数据库模式下，默认用户名为admin，密码为123456

3. **模块功能不可用**
   - 检查`module-config.properties`中相应模块是否启用
   - 查看应用日志中是否有相关错误信息 