# 环境配置
SPRING_PROFILES_ACTIVE=prod
ENVIRONMENT=prod

# 服务器配置
SERVER_PORT=8080
SERVER_CONTEXT_PATH=/api

# 数据库配置
SPRING_DATASOURCE_URL=jdbc:mysql://localhost:3306/law_firm?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8&allowPublicKeyRetrieval=true
SPRING_DATASOURCE_USERNAME=root
SPRING_DATASOURCE_PASSWORD=lawfirm_default
SPRING_DATASOURCE_DRIVER_CLASS_NAME=com.mysql.cj.jdbc.Driver

# HikariCP连接池配置
SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE=5
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE=15
SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT=30000
SPRING_DATASOURCE_HIKARI_MAX_LIFETIME=1800000
SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT=30000
SPRING_DATASOURCE_HIKARI_VALIDATION_TIMEOUT=5000
SPRING_DATASOURCE_HIKARI_POOL_NAME=LawFirmHikariCP
SPRING_DATASOURCE_HIKARI_LEAK_DETECTION_THRESHOLD=30000
SPRING_DATASOURCE_HIKARI_CONNECTION_TEST_QUERY=SELECT 1

# Redis配置
SPRING_REDIS_HOST=localhost
SPRING_REDIS_PORT=6379
SPRING_REDIS_DATABASE=0
SPRING_REDIS_TIMEOUT=10s
SPRING_REDIS_LETTUCE_POOL_MIN_IDLE=0
SPRING_REDIS_LETTUCE_POOL_MAX_IDLE=8
SPRING_REDIS_LETTUCE_POOL_MAX_ACTIVE=8
SPRING_REDIS_LETTUCE_POOL_MAX_WAIT=-1ms
SPRING_REDIS_LETTUCE_POOL_SHUTDOWN_TIMEOUT=100ms

# MinIO配置
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_NAME=law-firm
MINIO_REGION=us-east-1
MINIO_SECURE=false

# Flyway配置
SPRING_FLYWAY_ENABLED=true
SPRING_FLYWAY_BASELINE_ON_MIGRATE=true
SPRING_FLYWAY_VALIDATE_ON_MIGRATE=true
SPRING_FLYWAY_OUT_OF_ORDER=true
SPRING_FLYWAY_PLACEHOLDERS_SCHEMA=law_firm
SPRING_FLYWAY_CLEAN_DISABLED=true
SPRING_FLYWAY_MIXED=true
SPRING_FLYWAY_GROUP=true

# 搜索配置
LAWFIRM_SEARCH_ENABLED=true
LAWFIRM_SEARCH_TYPE=lucene
LAWFIRM_LUCENE_INDEX_PATH=/data/law-firm/lucene

# 知识管理搜索配置
KNOWLEDGE_SEARCH_HIGHLIGHT=true
KNOWLEDGE_SEARCH_MAX_RESULTS=1000
KNOWLEDGE_SEARCH_MIN_KEYWORD=2

# 服务器配置
SERVER_COMPRESSION_ENABLED=true
SERVER_TOMCAT_THREADS_MAX=200
SERVER_TOMCAT_THREADS_MIN=10
SERVER_TOMCAT_MAX_CONNECTIONS=8192
SERVER_TOMCAT_ACCEPT_COUNT=100
SERVER_TOMCAT_CONNECTION_TIMEOUT=5000
SERVER_TOMCAT_KEEP_ALIVE_TIMEOUT=20000
SERVER_TOMCAT_MAX_HTTP_HEADER_SIZE=8192
SERVER_TOMCAT_MAX_HTTP_POST_SIZE=10485760

# 监控配置
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=always
MANAGEMENT_ENDPOINT_HEALTH_SHOW_COMPONENTS=always
MANAGEMENT_ENDPOINT_METRICS_ENABLED=true
MANAGEMENT_ENDPOINT_PROMETHEUS_ENABLED=true
MANAGEMENT_ENDPOINT_HEALTH_PROBES_ENABLED=true
MANAGEMENT_ENDPOINT_HEALTH_LIVENESS_STATE_ENABLED=true
MANAGEMENT_ENDPOINT_HEALTH_READINESS_STATE_ENABLED=true

# 环境特定配置
# 本地环境
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE_LOCAL=15
SPRING_REDIS_DATABASE_LOCAL=0

# Docker环境
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE_DOCKER=20
SPRING_REDIS_DATABASE_DOCKER=0

# 测试环境
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE_TEST=10
SPRING_REDIS_DATABASE_TEST=1

# 生产环境
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE_PROD=50
SPRING_REDIS_DATABASE_PROD=0
SPRING_REDIS_LETTUCE_POOL_MAX_ACTIVE_PROD=32
SPRING_REDIS_LETTUCE_POOL_MAX_IDLE_PROD=16
SPRING_REDIS_LETTUCE_POOL_MIN_IDLE_PROD=8

# 日志配置
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_APP=INFO
LOGGING_LEVEL_SPRING=INFO
LOGGING_LEVEL_HIKARI=INFO
LOGGING_LEVEL_MYBATIS=INFO
LOGGING_FILE_NAME=logs/application.log
LOGGING_FILE_MAX_SIZE=100MB
LOGGING_FILE_MAX_HISTORY=30
LOGGING_FILE_TOTAL_SIZE_CAP=3GB
LOGGING_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
LOGGING_PATTERN_FILE=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# 生产环境特定配置
DB_HOST=localhost
DB_PORT=3306
DB_NAME=law_firm
DB_USERNAME=root
DB_PASSWORD=lawfirm_default

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# CORS配置
CORS_ALLOWED_ORIGINS=*
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

XSS_EXCLUDE_URLS=/api/upload
SQL_INJECTION_EXCLUDE_URLS=

RATE_LIMIT_GLOBAL=1000
RATE_LIMIT_PERIOD=60s
RATE_LIMIT_IP=100
RATE_LIMIT_IP_PERIOD=60s
RATE_LIMIT_USER=50
RATE_LIMIT_USER_PERIOD=60s

# SSL配置
SSL_ENABLED=false
SSL_KEY_STORE=classpath:keystore.p12
SSL_KEY_STORE_PASSWORD=changeit
SSL_KEY_STORE_TYPE=PKCS12
SSL_KEY_ALIAS=tomcat

# 缓存配置
CACHE_TTL=3600000
CACHE_NULL_VALUES=false
CACHE_KEY_PREFIX=lawfirm:
CACHE_USE_KEY_PREFIX=true

# 线程池配置
SPRING_TASK_EXECUTION_POOL_CORE_SIZE=10
SPRING_TASK_EXECUTION_POOL_MAX_SIZE=20
SPRING_TASK_EXECUTION_POOL_QUEUE_CAPACITY=100
SPRING_TASK_EXECUTION_POOL_KEEP_ALIVE=60s
SPRING_TASK_EXECUTION_POOL_ALLOW_CORE_THREAD_TIMEOUT=true
SPRING_TASK_EXECUTION_POOL_THREAD_NAME_PREFIX=spring-task-executor-

SPRING_TASK_SCHEDULING_POOL_SIZE=10
SPRING_TASK_SCHEDULING_POOL_THREAD_NAME_PREFIX=spring-task-scheduler-

# 性能监控配置
MANAGEMENT_METRICS_ENABLE_ALL=true
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HTTP_SERVER_REQUESTS=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HTTP_CLIENT_REQUESTS=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_JVM_MEMORY_USED=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_JVM_GC_PAUSE=true

# JVM配置
JVM_XMS=2g
JVM_XMX=4g
JVM_XMN=1g
JVM_METASPACE_SIZE=256m
JVM_MAX_METASPACE_SIZE=512m
JVM_HEAP_DUMP_PATH=./logs/heapdump.hprof
JVM_GC_LOG_PATH=./logs/gc.log
JVM_MAX_GC_PAUSE_MILLIS=200
JVM_INITIATING_HEAP_OCCUPANCY_PERCENT=45
JVM_MAX_TENURING_THRESHOLD=15
JVM_G1_HEAP_REGION_SIZE=8m
JVM_STRING_DEDUPLICATION_AGE_THRESHOLD=3

# 系统配置
SYSTEM_TEMP_DIR=/tmp
SYSTEM_LOG_DIR=./logs
SYSTEM_PID_FILE=./logs/pid
SYSTEM_MAX_OPEN_FILES=65535
SYSTEM_MAX_MAP_COUNT=262144
SYSTEM_SWAPPINESS=10

# 监控告警配置
MANAGEMENT_ENDPOINTS_WEB_BASE_PATH=/actuator
MANAGEMENT_ENDPOINTS_WEB_PATH_MAPPING_HEALTH=health
MANAGEMENT_ENDPOINTS_WEB_PATH_MAPPING_INFO=info
MANAGEMENT_ENDPOINTS_WEB_PATH_MAPPING_METRICS=metrics
MANAGEMENT_ENDPOINTS_WEB_PATH_MAPPING_PROMETHEUS=prometheus

MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HTTP_SERVER_REQUESTS=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HTTP_CLIENT_REQUESTS=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_JVM_MEMORY_USED=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_JVM_GC_PAUSE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_PROCESS_CPU_USAGE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_SYSTEM_CPU_USAGE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_TOMCAT_SESSIONS_ACTIVE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_TOMCAT_THREADS_BUSY=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HIKARICP_CONNECTIONS_ACTIVE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_HIKARICP_CONNECTIONS_IDLE=true
MANAGEMENT_METRICS_DISTRIBUTION_PERCENTILES_HISTOGRAM_REDIS_LETTUCE_COMMAND_COMPLETION=true

MANAGEMENT_PROMETHEUS_STEP=1m
MANAGEMENT_PROMETHEUS_DESCRIPTIONS=true

MANAGEMENT_HEALTH_DISKSPACE_PATH=./logs
MANAGEMENT_HEALTH_DISKSPACE_THRESHOLD=10GB

# 告警阈值配置
ALERT_CPU_USAGE_THRESHOLD=80
ALERT_MEMORY_USAGE_THRESHOLD=85
ALERT_DISK_USAGE_THRESHOLD=90
ALERT_GC_PAUSE_THRESHOLD=1000
ALERT_THREAD_POOL_USAGE_THRESHOLD=80
ALERT_DB_CONNECTION_USAGE_THRESHOLD=80
ALERT_REDIS_MEMORY_USAGE_THRESHOLD=85

# 安全头配置
SECURITY_HEADERS_HSTS_MAX_AGE=31536000
SECURITY_HEADERS_CSP=default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:;
SECURITY_HEADERS_XFO=DENY
SECURITY_HEADERS_XCTO=nosniff
SECURITY_HEADERS_XXSSP=1; mode=block
SECURITY_HEADERS_REFERRER=strict-origin-when-cross-origin

# 审计日志配置
SECURITY_AUDIT_LOG_PATH=./logs/audit.log
SECURITY_AUDIT_LOG_MAX_SIZE=100MB
SECURITY_AUDIT_LOG_MAX_HISTORY=30

# 会话配置
SPRING_SESSION_TIMEOUT=30m
SPRING_SESSION_COOKIE_SECURE=true
SPRING_SESSION_COOKIE_HTTP_ONLY=true
SPRING_SESSION_COOKIE_SAME_SITE=strict

# 密码策略配置
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=32
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL_CHAR=true
PASSWORD_HISTORY_SIZE=5
PASSWORD_EXPIRY_DAYS=90
PASSWORD_MAX_ATTEMPTS=5
PASSWORD_LOCKOUT_DURATION=30m

# 登录策略配置
LOGIN_MAX_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=30m
LOGIN_SESSION_TIMEOUT=30m
LOGIN_REMEMBER_ME_ENABLED=false